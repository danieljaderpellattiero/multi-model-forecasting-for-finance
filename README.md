# Multi-model Forecasting for Finance

## Learning objectives and skills to be acquired

The student will acquire skills in the design, implementation and validation of machine learning pipelines, with specific reference to the use of algorithms and multiple models for the prediction of financial indicators.  
From a software perspective, the student will acquire skills in the use of Python and major Machine Learning libraries, especially algorithms capable of working on time-series data.

## Organization of the internship

The internship includes an initial phase of state-of-the-art analysis and identification of both the most relevant Machine Learning approaches and the most interesting and challenging tasks in the world of financial trading.  
This will be followed by a critical evaluation of what has been learned in order to identify a task of specific interest, along with a set of the most promising algorithms.
  
Finally, a software that can effectively and efficiently combine these algorithms in order to improve their overall performance will be implemented.

## Deep learning Models

### WSAEs-LSTM ~ №1

- [Recurrent Neural Networks for Financial Time-Series modelling](https://ieeexplore.ieee.org/abstract/document/8545666)

### CEEMDAN-LSTM ~ №2

- [Financial time series forecasting model based on CEEMDAN and LSTM](https://www.sciencedirect.com/science/article/abs/pii/S0378437118314985)

- [Carbon price forecasting based on CEEMDAN and LSTM](https://www.sciencedirect.com/science/article/abs/pii/S0306261922000782?via=ihub)

### CNN-LSTM ~ №3

- [A CNN–LSTM model for gold price time-series forecasting](https://link.springer.com/article/10.1007/s00521-020-04867-x)

### MP-CNN-BDLSTM ~ №4


- [Novel Deep Learning Model with CNN and Bi-Directional LSTM for Improved Stock Market Index Prediction](https://ieeexplore.ieee.org/document/8666592)

### How to use them

1. Open the project folder using a Python IDE. (_preferably [PyCharm](https://www.jetbrains.com/pycharm/)_)
2. Install the required dependencies.
3. Open the `Main.py` file and insert, inside the second constructor parameter, all the desired stocks tickers as strings. (_just like the pre-inserted ticker "^KS11"_)
4. Launch the model using the same file.

### Further notes

- The models will print out step-by-step notifications in the terminal.
- The models will locally save, for each stock, the downloaded data in order to allow multiple subsequent executions. (_data will be located inside the `./M[model_number]/data` folder_)
- The models will locally save, for each stock, their parameters and weights to allow model reloading from disk. (_models configs will be located inside the `./M[model_number]/models` folder_)
- The models will locally export, for each stock, graphs related to data preprocessing phase and forecasts. (_graphs will be located inside the `./M[model_number]/images/data-preprocessing` and `./M[model_number]/images/predictions` folders_)
- The models will export in a csv file the forecasted values and the error metrics, which will be used by the Multi-model. (_csv files will be located inside the `./M[model_number]/predictions` folder_)

> Source code documentation will be enriched in the future.

## The Multi-model

### How to use it (^KS11 example)

1. Create inside `./MultiModel/data` a folder named `^KS11`.
2. Place inside the aforementioned folder the stock data. (_data can be taken from `./M1/data/^KS11/test_run_[X]`\, taking care to add the "test\_run\_0\_" prefix to each csv file name_)
3. Create inside `./MultiModel/models_predictions/M[model_number]` a folder named `^KS11` and place inside it (them) the respective predictions of each model. (_predictions can be taken from the `./M[model_number]/predictions/^KS11/test_run_[X]` folder_)
4. Run the Multi-model by launching the `./MultiModel/Main.py` file.
5. The Multi-model will export, for each stock, graphs for the individual and ensembled predictions. (_graphs will be located inside the `./MultiModel/images/^KS11/single_predictions` and `./MultiModel/images/^KS11/ensembled_predictions` folders_)
6. The Multi-model will export, for each stock, a csv file with the metrics for the individual and ensembled predictions. (_csv files will be located inside the `./MultiModel/results/^KS11` folder_)

> The "individual predictions" are those generated by each individual model, whereas the "ensembled" ones are those generated by jointly using the models. (_the way the models predictions are combined is described thoroughly in the thesis_)

## Euronext Data Loader

It is a Python module that allows to transform the raw data provided by the Euronext Milan Group into datasets that can be used to train the deep learning models.  
The provided market data and the derived predictions are subject to a non-disclosure agreement, therefore will not be uploaded into the repository.  
Nevertheless, the models were meant to be run on any financial instrument that can be found in Yahoo Finance.

### Euronext Data

The Markets Analysis Team provided us Limit Order Book (intra-day) data from 1st September 2022 to 24th March 2023, at millisecond intervals, for the following basket of financial instruments:

1. **Intesa Sanpaolo** - IT0000072618
2. **Enel** - IT0003128367
3. **Ferrari** - NL0011585146
4. **Campari** - NL0015435975
5. **Nexi** - IT0005366767
6. **Prysmian** - IT0004176001
7. **Leonardo** - IT0003856405
8. **Azimut** - IT0003261697
9. **Moncler** - IT0004965148
10. **Poste Italiane** - IT0003796171

### Data preprocessing

For each financial instrument an amount of _test runs_ (three for every trading day) is generated.  
Each trading day is therefore split according to the following schema:  

- **1st test run:** trading data within **09:00 - 12:00**
- **2nd test run:** trading data within **12:00 - 15:00**
- **3rd test run:** trading data within **15:00 - 18:00**

> Negotiations on the Euronext Milan market take place with the following schedules:
>
> - Opening auctions*: 08:00 - 09:00 (09:00:00 - 09:00:59)
> - Continuous negotiation: 09:00 - 17:30
> - Closing auctions*: 17:30 - 17:35 (17:35:00 - 17:35:59)
> - Trading at the closing auction price**: 17:35 (17:35:00 - 17:35:59) - 17:42
>
> \* _Pre-auction, validation, opening and conclusion of contracts._  
> \*\* _Proposal entry phase, negotiation phase._

In order to train the models each test run is further split into three datasets, according to the following percentages:

- **Training set - 80%**
- **Validation set - 15%**
- **Test set - 5%**

### Open, High, Low, Close (OHLC) data

The forecasts and graphs included in my thesis were generated on the Korea Composite Stock Price Index. (KOSPI, ^KS11)  
Daily OHLC data from January 1st 2015 was used to build the test runs, each of them comprising 3 years of training data, 10 months of validation data and 5 months of test data. (70-20-10 ratio)  
The beginning of each test run is shifted 5 months ahead relatively to its preceding.
